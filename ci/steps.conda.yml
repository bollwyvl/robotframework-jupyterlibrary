steps:
  - task: CondaEnvironment@1
    inputs:
      createOptions: -c conda-forge -c defaults
      createCustomEnvironment: true
      updateConda: false
      environmentName: robotframework-jupyterlibrary
      packageSpecs: >
        black
        conda-verify
        flake8
        geckodriver
        isort
        jupyterlab
        nodejs>8,<9
        pillow
        python-chromedriver-binary
        python>=3.6,<3.7
        robotframework
        robotframework-lint
        robotframework-seleniumlibrary
  - ${{ if eq(parameters.name, 'Linux') }}:
    - script: sudo chown -R $UID /usr/envs/robotframework-jupyterlibrary
      displayName: Fix Conda env permissions on Linux
  - ${{ if eq(parameters.name, 'MacOSX') }}:
    - script: sudo chown -R $UID /usr/local/miniconda/envs/robotframework-jupyterlibrary
      displayName: Fix Conda env permissions on MacOSX
  - script: pip install nteract_on_jupyter --no-deps --ignore-installed -vv
    displayName: Pip dependencies
